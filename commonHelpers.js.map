{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\nsearchForm: document.getElementById(\"searchForm\"),\ngalleryImages: document.querySelector(\"ul.gallery\"),\nloader: document.querySelector(\".loader\"),\nloadBtn: document.querySelector(\".load-btn\"),\n}\n\nconst queryParams = {\nperPage: 40,\npage: 1,\nquery: \"\",\nmaxPage: 0,\n}\n\nconst classHidden = \"is-hidden\";\n\nrefs.loader.style.display = \"none\";\n\nrefs.searchForm.addEventListener(\"submit\", searchFormSubmit);\nrefs.loadBtn.addEventListener(\"click\", loadMoreImagesBtn);\n\nasync function searchFormSubmit (evt) {\n    evt.preventDefault();\n\n    refs.galleryImages.innerHTML = \"\";\n\n    const form = evt.currentTarget;\n    queryParams.query = form.elements.searchQuery.value.trim();\n    \n    if (!queryParams.query) {\n        return;\n    }\n\n    queryParams.page = 1; \n\n    refs.loader.style.display = \"block\";\n\n    try {\n        const { hits, totalHits } = await fetchImages(queryParams);\n\n        queryParams.maxPage = Math.ceil(totalHits / queryParams.perPage);\n        \n        if (hits.length > 0 && hits.length !== totalHits) {\n            refs.loadBtn.classList.remove(classHidden);\n\n           renderImages(hits, refs.galleryImages);\n\n        } else {\n            refs.loadBtn.classList.add(classHidden);\n            iziToast.show({\n                message: 'âŒSorry, there are no images matching your search query. Please try again!',\n                messageColor: '#ffffff',\n                backgroundColor: '#EF4040',\n                position: 'topRight',\n                maxWidth: '420px',\n                close: false,\n            });\n\n            refs.galleryImages.innerHTML = \"\";\n        }\n    } catch(error) {\n        onFetchError(error);\n    } finally {\n        form.reset();\n    }\n}\n\nfunction fetchImages({ query, page = 1, perPage }) {\n    return axios.get(`https://pixabay.com/api/?key=41802498-7aef04e1b4b4791f33c618bc1`, {\n        params: {\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            perPage,\n            page,\n        }\n    })\n    .then(({ data }) => data);\n} \n\n   async function loadMoreImagesBtn() {\n        queryParams.page += 1;\n\n        refs.loader.style.display = \"none\";\n        refs.loadBtn.disablet = true;\n        \n    try {\n\n        const { hits } = await fetchImages(queryParams);\n\n           renderImages(hits, refs.galleryImages);\n\n        } catch(error) {\n            onFetchError(error);\n        } finally {\n            refs.loader.style.display = \"none\";\n            refs.loadBtn.disablet = false;\n        }\n\n        if(queryParams.page === queryParams.maxPage) {\n            refs.loadBtn.classList.add(classHidden);\n            refs.loader.style.display = \"none\";\n            refs.loadBtn.removeEventListener(\"click\", loadMoreImagesBtn);\n        }\n    }\n   \nfunction renderImages(images) { \nconst markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n <li class=\"gallery-item\">\n <a class=\"link-gallery\" href=\"${largeImageURL}\">\n <img class=\"gallery-images\" src=\"${webformatURL}\" alt=\"${tags}\">\n </a>\n <div class=\"photo-info\">\n     <p class=\"info-number\"><strong>Like</strong> ${likes}</p>\n     <p class=\"info-number\"><strong>Views</strong> ${views}</p>\n     <p class=\"info-number\"><strong>Comments</strong> ${comments}</p>\n     <p class=\"info-number\"><strong>Downloads</strong> ${downloads}</p> \n </div>\n </li>\n`\n}).join(\"\");\n\nrefs.galleryImages.insertAdjacentHTML(\"beforeend\", markup);\n    \nconst lightbox = new SimpleLightbox(document.querySelectorAll('.gallery a'));\n\n    lightbox.refresh();\n}\n\nfunction onFetchError(error) {\n    console.log(error);\n    refs.loader.style.display = \"none\";\n}"],"names":["refs","queryParams","classHidden","searchFormSubmit","loadMoreImagesBtn","evt","form","hits","totalHits","fetchImages","renderImages","iziToast","error","onFetchError","query","page","perPage","axios","data","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox"],"mappings":"owBAOA,MAAMA,EAAO,CACb,WAAY,SAAS,eAAe,YAAY,EAChD,cAAe,SAAS,cAAc,YAAY,EAClD,OAAQ,SAAS,cAAc,SAAS,EACxC,QAAS,SAAS,cAAc,WAAW,CAC3C,EAEMC,EAAc,CACpB,QAAS,GACT,KAAM,EACN,MAAO,GACP,QAAS,CACT,EAEMC,EAAc,YAEpBF,EAAK,OAAO,MAAM,QAAU,OAE5BA,EAAK,WAAW,iBAAiB,SAAUG,CAAgB,EAC3DH,EAAK,QAAQ,iBAAiB,QAASI,CAAiB,EAExD,eAAeD,EAAkBE,EAAK,CAClCA,EAAI,eAAc,EAElBL,EAAK,cAAc,UAAY,GAE/B,MAAMM,EAAOD,EAAI,cAGjB,GAFAJ,EAAY,MAAQK,EAAK,SAAS,YAAY,MAAM,OAEhD,EAACL,EAAY,MAIjB,CAAAA,EAAY,KAAO,EAEnBD,EAAK,OAAO,MAAM,QAAU,QAE5B,GAAI,CACA,KAAM,CAAE,KAAAO,EAAM,UAAAC,CAAS,EAAK,MAAMC,EAAYR,CAAW,EAEzDA,EAAY,QAAU,KAAK,KAAKO,EAAYP,EAAY,OAAO,EAE3DM,EAAK,OAAS,GAAKA,EAAK,SAAWC,GACnCR,EAAK,QAAQ,UAAU,OAAOE,CAAW,EAE1CQ,EAAaH,EAAMP,EAAK,aAAa,IAGpCA,EAAK,QAAQ,UAAU,IAAIE,CAAW,EACtCS,EAAS,KAAK,CACV,QAAS,4EACT,aAAc,UACd,gBAAiB,UACjB,SAAU,WACV,SAAU,QACV,MAAO,EACvB,CAAa,EAEDX,EAAK,cAAc,UAAY,GAEtC,OAAOY,EAAN,CACEC,EAAaD,CAAK,CAC1B,QAAc,CACNN,EAAK,MAAK,CACb,EACL,CAEA,SAASG,EAAY,CAAE,MAAAK,EAAO,KAAAC,EAAO,EAAG,QAAAC,CAAO,EAAI,CAC/C,OAAOC,EAAM,IAAI,kEAAmE,CAChF,OAAQ,CACJ,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,QAAAE,EACA,KAAAD,CACH,CACT,CAAK,EACA,KAAK,CAAC,CAAE,KAAAG,CAAM,IAAKA,CAAI,CAC5B,CAEG,eAAed,GAAoB,CAC9BH,EAAY,MAAQ,EAEpBD,EAAK,OAAO,MAAM,QAAU,OAC5BA,EAAK,QAAQ,SAAW,GAE5B,GAAI,CAEA,KAAM,CAAE,KAAAO,CAAM,EAAG,MAAME,EAAYR,CAAW,EAE3CS,EAAaH,EAAMP,EAAK,aAAa,CAEvC,OAAOY,EAAN,CACEC,EAAaD,CAAK,CAC9B,QAAkB,CACNZ,EAAK,OAAO,MAAM,QAAU,OAC5BA,EAAK,QAAQ,SAAW,EAC3B,CAEEC,EAAY,OAASA,EAAY,UAChCD,EAAK,QAAQ,UAAU,IAAIE,CAAW,EACtCF,EAAK,OAAO,MAAM,QAAU,OAC5BA,EAAK,QAAQ,oBAAoB,QAASI,CAAiB,EAElE,CAEL,SAASM,EAAaS,EAAQ,CAC9B,MAAMC,EAASD,EAAO,IAAI,CAAC,CAAE,aAAAE,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IACtF;AAAA;AAAA,iCAEsBL;AAAA,oCACGD,WAAsBE;AAAA;AAAA;AAAA,oDAGNC;AAAA,qDACCC;AAAA,wDACGC;AAAA,yDACCC;AAAA;AAAA;AAAA,CAIxD,EAAE,KAAK,EAAE,EAEV3B,EAAK,cAAc,mBAAmB,YAAaoB,CAAM,EAExC,IAAIQ,EAAe,SAAS,iBAAiB,YAAY,CAAC,EAE9D,QAAO,CACpB,CAEA,SAASf,EAAaD,EAAO,CACzB,QAAQ,IAAIA,CAAK,EACjBZ,EAAK,OAAO,MAAM,QAAU,MAChC"}