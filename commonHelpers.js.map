{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\nsearchForm: document.getElementById(\"searchForm\"),\ngalleryImages: document.querySelector(\"ul.gallery\"),\nloader: document.querySelector(\".loader\"),\nloadBtn: document.querySelector(\".load-btn\"),\ngalleryItem: document.querySelector(\"ul.gallery-item\"),\n};\n\nconst queryParams = {\nperPage: 40,\npage: 1,\nquery: \"\",\nmaxPage: 0,\n};\n\nrefs.searchForm.addEventListener(\"submit\", searchFormSubmit);\n\nfunction attachLoadMoreEvent() {\n    refs.loadBtn.addEventListener(\"click\", loadMoreImagesBtn);\n}\n\nfunction detachLoadMoreEvent() {\n    refs.loadBtn.removeEventListener(\"click\", loadMoreImagesBtn);\n}\n\nasync function searchFormSubmit (evt) {\n    evt.preventDefault();\n\n    const form = evt.currentTarget;\n    queryParams.query = form.elements.searchQuery.value.trim();\n    \n    if (!queryParams.query) {\n        return;\n    }\n    refs.loadBtn.classList.add(\"is-hidden\");  \n    \n    refs.galleryImages.innerHTML = \"\";\n    queryParams.page = 1;\n    refs.loader.classList.remove(\"is-hidden\");\n \n    try {\n        const { hits, totalHits } = await fetchImages(queryParams);\n\n        queryParams.maxPage = Math.ceil(totalHits / queryParams.perPage);\n\n        renderImages(hits, refs.galleryImages);\n\n        smoothScrollToNextGroup();\n\n        if (hits.length >= queryParams.perPage) {\n            refs.loadBtn.classList.remove(\"is-hidden\"); \n    attachLoadMoreEvent();\n\n        } else {\n            refs.loader.classList.add(\"is-hidden\");\n            refs.loadBtn.classList.add(\"is-hidden\");  \n        }\n\n        if(hits.length === 0) {\n            refs.loader.classList.add(\"is-hidden\");\n            refs.loadBtn.classList.add(\"is-hidden\")\n            iziToast.show({\n                message: 'âŒSorry, there are no images matching your search query. Please try again!',\n                messageColor: '#ffffff',\n                backgroundColor: '#EF4040',\n                position: 'topRight',\n                maxWidth: '420px',\n                close: false,\n            });\n        } \n    } catch(error) {\n        onFetchError(error);\n    } finally {\n        form.reset();\n    }\n}\n\nfunction fetchImages({ query, page = 1, perPage }) {\n    return axios.get(`https://pixabay.com/api/?key=41802498-7aef04e1b4b4791f33c618bc1`, {\n        params: {\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: perPage,\n            page,\n        }\n    })\n    .then(({ data }) => data);\n} \n\n   async function loadMoreImagesBtn() {\n    queryParams.page += 1;\n    refs.loader.classList.remove(\"is-hidden\");\n    refs.loadBtn.disabled = true;\n\n    try {\n        const { hits } = await fetchImages(queryParams);\n\n         renderImages(hits, refs.galleryImages);\n\n        if (hits.length < queryParams.perPage) {\n            refs.loadBtn.classList.add(\"is-hidden\");\n            detachLoadMoreEvent();\n        }       \n\n    } catch (error) {\n        onFetchError(error);\n    } finally {\n        refs.loader.classList.add(\"is-hidden\");\n        refs.loadBtn.disabled = false;\n    }\n\n    if (queryParams.page === queryParams.maxPage) {\n        iziToast.show({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            messageColor: '#ffffff',\n            backgroundColor: '#808080',\n            position: 'bottomLeft',\n            close: false,\n        });\n        refs.loadBtn.classList.add(\"is-hidden\");\n        detachLoadMoreEvent();\n    }\n    }\n\nlet lightboxInstance = null;\n   \nfunction renderImages(images) { \nconst markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n <li class=\"gallery-item\">\n <a class=\"link-gallery\" href=\"${largeImageURL}\">\n <img class=\"gallery-images\" src=\"${webformatURL}\" alt=\"${tags}\">\n </a>\n <div class=\"photo-info\">\n     <p class=\"info-number\"><strong>Like</strong> ${likes}</p>\n     <p class=\"info-number\"><strong>Views</strong> ${views}</p>\n     <p class=\"info-number\"><strong>Comments</strong> ${comments}</p>\n     <p class=\"info-number\"><strong>Downloads</strong> ${downloads}</p> \n </div>\n </li>\n`\n}).join(\"\");\n\nrefs.galleryImages.insertAdjacentHTML(\"beforeend\", markup);\n    \n    if (!lightboxInstance) {\n        lightboxInstance = new SimpleLightbox('.gallery a');\n    } else {\n        lightboxInstance.refresh();\n    }\n}\n\nfunction onFetchError(error) {\n    iziToast.error({\n        title: 'Error',\n        message: 'Wrong operation!!!',\n    });\n    refs.loader.classList.add(\"is-hidden\");\n    refs.loadBtn.classList.add(\"is-hidden\");\n}\n\nfunction smoothScrollToNextGroup() {\n    if (refs.galleryItem) {\n      const galleryItemHeight = refs.galleryItem.getBoundingClientRect().height;\n      window.scrollBy({\n        top: galleryItemHeight * 2, \n        behavior: \"smooth\",\n      });\n    }\n  }\n "],"names":["refs","queryParams","searchFormSubmit","attachLoadMoreEvent","loadMoreImagesBtn","detachLoadMoreEvent","evt","form","hits","totalHits","fetchImages","renderImages","smoothScrollToNextGroup","iziToast","onFetchError","query","page","perPage","axios","data","lightboxInstance","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","error","galleryItemHeight"],"mappings":"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"}