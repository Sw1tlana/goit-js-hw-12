{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\nsearchForm: document.getElementById(\"searchForm\"),\ngalleryImages: document.querySelector(\"ul.gallery\"),\nloader: document.querySelector(\".loader\"),\nloadBtn: document.querySelector(\".load-btn\"),\n}\n\nconst queryParams = {\nperPage: 40,\npage: 1,\nquery: \"\",\nmaxPage: 0,\n}\n\nrefs.loader.style.display = \"none\";\nrefs.loadBtn.style.display = \"none\";\n\nrefs.searchForm.addEventListener(\"submit\", searchFormSubmit);\n\nasync function searchFormSubmit (evt) {\n    evt.preventDefault();\n\n    const form = evt.currentTarget;\n    queryParams.query = form.elements.searchQuery.value.trim();\n    \n    if (!queryParams.query) {\n        return;\n    }\n    \n    refs.galleryImages.innerHTML = \"\";\n    queryParams.page = 1; \n    refs.loader.style.display = \"block\";\n    \n    try {\n        const { hits, totalHits } = await fetchImages(queryParams);\n\n        queryParams.maxPage = Math.ceil(totalHits / queryParams.perPage);\n        console.log(queryParams.maxPage)\n        renderImages(hits, refs.galleryImages)\n\n        if (hits.length > 0 && hits.length !== totalHits) {\n            refs.loadBtn.style.display = \"block\";\n\n        refs.loadBtn.addEventListener(\"click\", loadMoreImagesBtn);\n\n        } else {\n            refs.loadBtn.style.display = \"none\";\n            refs.loader.style.display = \"none\";\n            iziToast.show({\n                message: 'âŒSorry, there are no images matching your search query. Please try again!',\n                messageColor: '#ffffff',\n                backgroundColor: '#EF4040',\n                position: 'topRight',\n                maxWidth: '420px',\n                close: false,\n            });\n        }\n    } catch(error) {\n        onFetchError(error);\n    } finally {\n        form.reset();\n    }\n}\n\nfunction fetchImages({ query, page = 1, perPage }) {\n    return axios.get(`https://pixabay.com/api/?key=41802498-7aef04e1b4b4791f33c618bc1`, {\n        params: {\n            q: query,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            perPage,\n            page,\n        }\n    })\n    .then(({ data }) => data);\n} \n\n   async function loadMoreImagesBtn() {\n    queryParams.page += 1;\n    refs.loader.style.display = \"block\";\n    refs.loadBtn.disabled = true;\n\n    try {\n        const { hits } = await fetchImages(queryParams);\n\n        renderImages(hits, refs.galleryImages);\n\n    } catch (error) {\n        onFetchError(error);\n    } finally {\n        refs.loader.style.display = \"none\";\n        refs.loadBtn.disabled = false;\n    }\n\n    if (queryParams.page === queryParams.maxPage) {\n        iziToast.show({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            messageColor: '#ffffff',\n            backgroundColor: '#808080',\n            position: 'bottomLeft',\n            close: false,\n        });\n        refs.loadBtn.style.display = \"none\";\n        refs.loader.style.display = \"none\";\n        refs.loadBtn.removeEventListener(\"click\", loadMoreImagesBtn);\n    }\n    }\n\nlet lightboxInstance = null;\n   \nfunction renderImages(images) { \nconst markup = images.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n    return `\n <li class=\"gallery-item\">\n <a class=\"link-gallery\" href=\"${largeImageURL}\">\n <img class=\"gallery-images\" src=\"${webformatURL}\" alt=\"${tags}\">\n </a>\n <div class=\"photo-info\">\n     <p class=\"info-number\"><strong>Like</strong> ${likes}</p>\n     <p class=\"info-number\"><strong>Views</strong> ${views}</p>\n     <p class=\"info-number\"><strong>Comments</strong> ${comments}</p>\n     <p class=\"info-number\"><strong>Downloads</strong> ${downloads}</p> \n </div>\n </li>\n`\n}).join(\"\");\n\nrefs.galleryImages.insertAdjacentHTML(\"beforeend\", markup);\n    \n    if (!lightboxInstance) {\n        lightboxInstance = new SimpleLightbox('.gallery a');\n    } else {\n        lightboxInstance.refresh();\n    }\n}\n\nfunction onFetchError(error) {\n    iziToast.error({\n        title: 'Error',\n        message: 'Wrong operation!!!',\n    });\n    refs.loader.style.display = \"none\";\n    refs.loadBtn.style.display = \"none\";\n\n}\n\nconst galleryItem = document.querySelector(\".gallery-item\");\n\nconst galleryItemHeight = galleryItem.getBoundingClientRect().height;\n\nfunction smoothScrollToNextGroup() {\n    window.scrollBy({\n        top: galleryItemHeight * 2, \n        behavior: \"smooth\",\n    });\n}\nsmoothScrollToNextGroup();"],"names":["refs","queryParams","searchFormSubmit","evt","form","hits","totalHits","fetchImages","renderImages","loadMoreImagesBtn","iziToast","onFetchError","query","page","perPage","axios","data","lightboxInstance","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","error","galleryItem","galleryItemHeight","smoothScrollToNextGroup"],"mappings":"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"}